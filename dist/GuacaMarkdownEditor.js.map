{"version":3,"file":"GuacaMarkdownEditor.js","sources":["GuacaAirPopUp.js","GuacaMarkdownEditor.js"],"sourcesContent":["/* global $ */\r\n\r\nexport default class GuacaAirPopUp {\r\n\t\r\n\tconstructor(editorElement, settings) {\r\n\t\tthis.settings = settings || this.getDefaultSettings();\t\t\r\n\t\tthis.airPopUp = $('<div></div>');\r\n\t\tthis.airPopUp.addClass(\"guaca-airpopup\");\r\n\t\tthis.addControls(this.settings.controls, this.airPopUp);\r\n\t\tthis.airPopUp.insertAfter(editorElement);\r\n\t\tthis.$window = $(window);\r\n\t}\r\n\t\r\n\t// API Start\r\n\t\r\n\tsetPosition(rect) {\r\n\t\tvar y = this.getComputedYPosition(rect.top, rect.bottom),\r\n\t\t\tx = this.getComputedXPosition(rect.left);\r\n\t\t\t\r\n\t\tthis.airPopUp.css(\"top\", y);\r\n\t\tthis.airPopUp.css(\"left\", x);\r\n\t\tthis.airPopUp.css(\"display\", \"block\");\r\n\t}\r\n\t\r\n\thide() {\r\n\t\tthis.airPopUp.css(\"display\", \"none\");\r\n\t}\r\n\t\r\n\tgetHeight() {\r\n\t\treturn this.airPopUp.innerHeight();\r\n\t}\r\n\t\r\n\tgetWidth() {\r\n\t\treturn this.airPopUp.innerWidth();\r\n\t}\r\n\t\r\n\t// API End\r\n\t\r\n\tgetComputedYPosition(top, bottom) {\r\n\t\tvar newYOffset = this.getHeight() + this.settings[\"y-spacing\"];\r\n\t\tvar y;\r\n\t\tif (top < newYOffset) y = bottom + this.settings[\"y-spacing\"];\r\n\t\telse y = top - newYOffset;\r\n\t\treturn y + this.$window.scrollTop();\r\n\t}\r\n\t\r\n\tgetComputedXPosition(left) {\r\n\t\tvar x = left;\r\n\t\tif (left + this.getWidth() + this.settings[\"x-spacing\"] > this.$window.innerWidth()) \r\n\t\t\tx = this.$window.innerWidth() - this.getWidth() - this.settings[\"x-spacing\"];\r\n\t\treturn x + this.$window.scrollLeft();\r\n\t}\r\n\t\r\n\taddControls(controls, element) {\r\n\t\tfor(var control of controls) {\r\n\t\t\tif(typeof control == \"object\" && control.length) {\r\n\t\t\t\tvar container =  $('<span class=\"container\"></button>');\r\n\t\t\t\tthis.addControls(control, container);\r\n\t\t\t\telement.append(container);\r\n\t\t\t}\r\n\t\t\telement.append(this.createControl(control));\r\n\t\t}\r\n\t}\r\n\t\r\n\tcreateControl(className) {\r\n\t\tvar control = $('<button></button>');\r\n\t\tcontrol.addClass(className);\r\n\t\treturn control;\r\n\t}\r\n\t\r\n\tgetDefaultControls() {\r\n\t\treturn [\r\n\t\t\t'bold',\r\n\t\t\t'italic',\r\n\t\t\t'divider',\r\n\t\t\t[\r\n\t\t\t\t'small-heading',\r\n\t\t\t\t'medium-heading',\r\n\t\t\t\t'large-heading'\r\n\t\t\t],\r\n\t\t\t'paragraph',\r\n\t\t\t'ol',\r\n\t\t\t'ul',\r\n\t\t\t'code'\r\n\t\t];\r\n\t}\r\n\t\r\n\tgetDefaultSettings() {\r\n\t\treturn {\r\n\t\t\t\"y-spacing\": 8,\r\n\t\t\t\"x-spacing\": 20,\r\n\t\t\t\"controls\": this.getDefaultControls()\r\n\t\t}\r\n\t}\r\n}","\"use strict\";\r\n\r\n/* global $ */\r\n\r\nimport GuacaAirPopUp from './GuacaAirPopUp';\r\n\r\nexport default class GuacaMarkdownEditor {\r\n\t\r\n\tconstructor(inputElement) {\r\n\t\tvar self = this;\r\n\t\tself.inputElement = inputElement;\r\n\t\tself.guacaEditorElement = this.setUpGuacaMarkdownElement();\r\n\t\tself.airPopUp = new GuacaAirPopUp(self.guacaEditorElement);\r\n\t\tself.currentSelection = null;\r\n\t\t\r\n\t\tinputElement.css(\"display\", \"none\");\r\n\t\tself.subscribeToEvents();\r\n\t\t\r\n\t}\r\n\t\r\n\t// API Start \r\n\t\r\n\tgetCurrentSelection() {\r\n\t\treturn this.currentSelection;\r\n\t}\r\n\t\r\n\t// API End\r\n\t\r\n\tsetUpGuacaMarkdownElement() {\r\n\t\tvar guacaElement = $('<div contentEditable=\"true\" class=\"guaca-editor\" ></div>');\r\n\t\tvar attributes = this.inputElement.prop(\"attributes\");\r\n\t\t\r\n\t\t$.each(attributes, (i, a) => {\r\n\t\t\tguacaElement.attr(a.name, a.value);\r\n\t\t});\r\n\t\t\r\n\t\tguacaElement.css(\"display\", \"inline-block\");\r\n\t\tguacaElement.addClass(\"guaca-editor\");\r\n\t\t\r\n\t\tguacaElement.insertAfter(this.inputElement);\r\n\t\t\r\n\t\treturn guacaElement;\r\n\t}\r\n\t\r\n\tsubscribeToEvents() {\r\n\t\tvar self = this;\r\n\t\tthis.guacaEditorElement.on('selectstart', () => {\r\n\t\t\tself.onSelectStart();\r\n\t\t\t$(document).one('mouseup', () => {\r\n\t\t\t\tself.onSelectText();\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.guacaEditorElement.on('blur', () => {\r\n\t\t\tself.airPopUp.hide();\r\n\t\t});\r\n\t}\r\n\t\r\n\tonSelectText() {\r\n\t\tthis.currentSelection = window.getSelection();\r\n\t\tif(this.currentSelection.type === \"Caret\") return;\r\n\t\tvar rect = this.currentSelection.getRangeAt(0).getBoundingClientRect();\r\n\t\tthis.airPopUp.setPosition(rect);\r\n\t}\r\n\t\r\n\tonSelectStart() {\r\n\t\tthis.airPopUp.hide();\r\n\t}\r\n}\r\n\r\n"],"names":[],"mappings":"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","sourceRoot":"/source/"}